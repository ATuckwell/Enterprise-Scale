{
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "input": {
      "value": {
        "Id": "/providers/Microsoft.Management/managementGroups/cyrus",
        "Type": "/providers/Microsoft.Management/managementGroups",
        "Name": "cyrus",
        "TenantId": "d6ad82f3-42af-4a15-ac1e-49e6c08f624e",
        "DisplayName": "Cyrus",
        "UpdatedTime": "0001-01-01T00:00:00Z",
        "UpdatedBy": null,
        "ParentId": "/providers/Microsoft.Management/managementGroups/d6ad82f3-42af-4a15-ac1e-49e6c08f624e",
        "ParentName": "d6ad82f3-42af-4a15-ac1e-49e6c08f624e",
        "ParentDisplayName": "d6ad82f3-42af-4a15-ac1e-49e6c08f624e",
        "Children": [
          {
            "Type": "/providers/Microsoft.Management/managementGroups",
            "Id": "/providers/Microsoft.Management/managementGroups/shared",
            "Name": "shared",
            "DisplayName": "Shared Infrastructure",
            "Children": null
          },
          {
            "Type": "/providers/Microsoft.Management/managementGroups",
            "Id": "/providers/Microsoft.Management/managementGroups/business",
            "Name": "business",
            "DisplayName": "Business Applications",
            "Children": [
              {
                "Type": "/providers/Microsoft.Management/managementGroups",
                "Id": "/providers/Microsoft.Management/managementGroups/ib",
                "Name": "ib",
                "DisplayName": "Investment Bank",
                "Children": null
              }
            ]
          }
        ],
        "properties": {
          "policyDefinitions": [
            {
              "Name": "75738d3a-7503-4bb8-9483-714042a92b9c",
              "ResourceId": "/providers/Microsoft.Management/managementGroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/75738d3a-7503-4bb8-9483-714042a92b9c",
              "ResourceName": "75738d3a-7503-4bb8-9483-714042a92b9c",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementGroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/75738d3a-7503-4bb8-9483-714042a92b9c",
              "Properties": {
                "Description": null,
                "DisplayName": "ApprovedVMImages",
                "Mode": "All",
                "Parameters": {
                  "imageIds": {
                    "type": "Array",
                    "metadata": {
                      "displayName": "Approved VM images",
                      "description": "The list of approved VM images. Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage' or /Subscriptions/<subscriptionId>/Providers/Microsoft.Compute/Locations/centralus/Publishers/MicrosoftWindowsServer/ArtifactTypes/VMImage/Offers/WindowsServer/Skus/2016-Datacenter/Versions/2016.127.20180510'"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "allOf": [
                      {
                        "field": "type",
                        "equals": "Microsoft.Compute/virtualMachines"
                      },
                      {
                        "not": {
                          "field": "Microsoft.Compute/imageId",
                          "in": "[parameters('imageIds')]"
                        }
                      }
                    ]
                  },
                  "then": {
                    "effect": "deny"
                  }
                }
              }
            },
            {
              "Name": "Deny-PublicIP",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
              "ResourceName": "Deny-PublicIP",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
              "Properties": {
                "Description": "Prevents the deployment of public IP address resources outside of a prescribed set of subnets",
                "DisplayName": "Deny-PublicIP",
                "Mode": "All",
                "Parameters": {
                  "subnets": {
                    "type": "Array",
                    "metadata": {
                      "displayName": "List of subnets that can contain a public IP address",
                      "description": "The subnets must be provided with as a list of resource IDs in the format of /subscriptions/{subscription_id}/resourcegroups/{resource_group}/providers/microsoft.network/virtualnetworks/{vnet-name}/subnets/{subnet-name})"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "allOf": [
                      {
                        "field": "type",
                        "equals": "Microsoft.Network/networkInterfaces"
                      },
                      {
                        "not": {
                          "field": "Microsoft.Network/networkInterfaces/ipconfigurations[*].publicIpAddress.id",
                          "exists": false
                        }
                      },
                      {
                        "not": {
                          "field": "Microsoft.Network/networkInterfaces/ipconfigurations[*].subnet.id",
                          "in": "[parameters('subnets')]"
                        }
                      }
                    ]
                  },
                  "then": {
                    "effect": "deny"
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonACI",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonACI",
              "ResourceName": "DINE-AzMonACI",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonACI",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.ContainerInstance/containerGroups"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonACR",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonACR",
              "ResourceName": "DINE-AzMonACR",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonACR",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.ContainerRegistry/registries"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.ContainerRegistry/registries/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonADF",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonADF",
              "ResourceName": "DINE-AzMonADF",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonADF",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.DataFactory/factories"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.DataFactory/factories/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "ActivityRuns",
                                      "enabled": true
                                    },
                                    {
                                      "category": "PipelineRuns",
                                      "enabled": true
                                    },
                                    {
                                      "category": "TriggerRuns",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonADLA",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonADLA",
              "ResourceName": "DINE-AzMonADLA",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonADLA",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.DataLakeAnalytics/accounts"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "Audit",
                                      "enabled": true
                                    },
                                    {
                                      "category": "Requests",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonADLS",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonADLS",
              "ResourceName": "DINE-AzMonADLS",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonADLS",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.DataLakeStore/accounts"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.DataLakeStore/accounts/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "Audit",
                                      "enabled": true
                                    },
                                    {
                                      "category": "Requests",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonAKS",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAKS",
              "ResourceName": "DINE-AzMonAKS",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAKS",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.ContainerService/managedClusters"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.ContainerService/managedClusters/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "guard",
                                      "enabled": true
                                    },
                                    {
                                      "category": "kube-apiserver",
                                      "enabled": true
                                    },
                                    {
                                      "category": "kube-controller-manager",
                                      "enabled": true
                                    },
                                    {
                                      "category": "kube-scheduler",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonAppGW",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAppGW",
              "ResourceName": "DINE-AzMonAppGW",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAppGW",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/applicationGateways"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/applicationGateways/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "ApplicationGatewayAccessLog",
                                      "enabled": true
                                    },
                                    {
                                      "category": "ApplicationGatewayPerformanceLog",
                                      "enabled": true
                                    },
                                    {
                                      "category": "ApplicationGatewayFirewallLog",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonAS",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAS",
              "ResourceName": "DINE-AzMonAS",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAS",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.AnalysisServices/servers"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "analysisName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.AnalysisServices/servers/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('analysisName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "Engine",
                                      "enabled": true
                                    },
                                    {
                                      "category": "Service",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "analysisName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonASA",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonASA",
              "ResourceName": "DINE-AzMonASA",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonASA",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.StreamAnalytics/streamingjobs"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "Authoring",
                                      "enabled": true
                                    },
                                    {
                                      "category": "Execution",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonAutomation",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAutomation",
              "ResourceName": "DINE-AzMonAutomation",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAutomation",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Automation/automationAccounts"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Automation/automationAccounts/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "JobLogs",
                                      "enabled": true
                                    },
                                    {
                                      "category": "JobStreams",
                                      "enabled": true
                                    },
                                    {
                                      "category": "DscNodeStatus",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonAzFirewall",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAzFirewall",
              "ResourceName": "DINE-AzMonAzFirewall",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAzFirewall",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/azureFirewalls"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/azureFirewalls/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "AzureFirewallApplicationRule",
                                      "enabled": true
                                    },
                                    {
                                      "category": "AzureFirewallNetworkRule",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonBackup",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonBackup",
              "ResourceName": "DINE-AzMonBackup",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonBackup",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.RecoveryServices/Vaults"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.RecoveryServices/Vaults/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "logs": [
                                    {
                                      "category": "AzureBackupReport",
                                      "enabled": true
                                    },
                                    {
                                      "category": "AzureSiteRecoveryEvents",
                                      "enabled": true
                                    },
                                    {
                                      "category": "AzureSiteRecoveryJobs",
                                      "enabled": true
                                    },
                                    {
                                      "category": "AzureSiteRecoveryProtectedDiskDataChurn",
                                      "enabled": true
                                    },
                                    {
                                      "category": "AzureSiteRecoveryRecoveryPoints",
                                      "enabled": true
                                    },
                                    {
                                      "category": "AzureSiteRecoveryReplicatedItems",
                                      "enabled": true
                                    },
                                    {
                                      "category": "AzureSiteRecoveryReplicationDataUploadRate",
                                      "enabled": true
                                    },
                                    {
                                      "category": "AzureSiteRecoveryReplicationStats",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonBatch",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonBatch",
              "ResourceName": "DINE-AzMonBatch",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonBatch",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Batch/batchAccounts"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Batch/batchAccounts/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "ServiceLog",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonCognitive",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonCognitive",
              "ResourceName": "DINE-AzMonCognitive",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonCognitive",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.CognitiveServices/accounts"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.CognitiveServices/accounts/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonCosmos",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonCosmos",
              "ResourceName": "DINE-AzMonCosmos",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonCosmos",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.DocumentDB/databaseAccounts"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "DataPlaneRequests",
                                      "enabled": true
                                    },
                                    {
                                      "category": "MongoRequests",
                                      "enabled": true
                                    },
                                    {
                                      "category": "QueryRuntimeStatistics",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonDNS",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonDNS",
              "ResourceName": "DINE-AzMonDNS",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonDNS",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/dnszones"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/dnszones/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonEGExtensionTopics",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEGExtensionTopics",
              "ResourceName": "DINE-AzMonEGExtensionTopics",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEGExtensionTopics",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.EventGrid/extensionTopics"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.EventGrid/extensionTopics/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonEGSubscription",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEGSubscription",
              "ResourceName": "DINE-AzMonEGSubscription",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEGSubscription",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.EventGrid/eventSubscriptions"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonEGTopics",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEGTopics",
              "ResourceName": "DINE-AzMonEGTopics",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEGTopics",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.EventGrid/topics"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.EventGrid/topics/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonEHClusters",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEHClusters",
              "ResourceName": "DINE-AzMonEHClusters",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEHClusters",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.EventHub/clusters"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.EventHub/clusters/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonEHNamespace",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEHNamespace",
              "ResourceName": "DINE-AzMonEHNamespace",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEHNamespace",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.EventHub/namespaces"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.EventHub/namespaces/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "ArchiveLogs",
                                      "enabled": true
                                    },
                                    {
                                      "category": "AutoScaleLogs",
                                      "enabled": true
                                    },
                                    {
                                      "category": "OperationalLogs",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonER",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonER",
              "ResourceName": "DINE-AzMonER",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonER",
              "Properties": {
                "Description": null,
                "DisplayName": "DINE-AzMonER",
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/expressRouteCircuits"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "PeeringRouteLog",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonHDInisght",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonHDInisght",
              "ResourceName": "DINE-AzMonHDInisght",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonHDInisght",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.HDInsight/clusters"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.HDInsight/clusters/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonIoT",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonIoT",
              "ResourceName": "DINE-AzMonIoT",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonIoT",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Devices/IotHubs"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "iotName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Devices/IotHubs/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('iotName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "Connections",
                                      "enabled": true
                                    },
                                    {
                                      "category": "DeviceTelemetry",
                                      "enabled": true
                                    },
                                    {
                                      "category": "C2DCommands",
                                      "enabled": true
                                    },
                                    {
                                      "category": "DeviceIdentityOperations",
                                      "enabled": true
                                    },
                                    {
                                      "category": "FileUploadOperations",
                                      "enabled": true
                                    },
                                    {
                                      "category": "Routes",
                                      "enabled": true
                                    },
                                    {
                                      "category": "D2CTwinOperations",
                                      "enabled": true
                                    },
                                    {
                                      "category": "C2DTwinOperations",
                                      "enabled": true
                                    },
                                    {
                                      "category": "TwinQueries",
                                      "enabled": true
                                    },
                                    {
                                      "category": "JobsOperations",
                                      "enabled": true
                                    },
                                    {
                                      "category": "DirectMethods",
                                      "enabled": true
                                    },
                                    {
                                      "category": "E2EDiagnostics",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "iotName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonIoTPoS",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonIoTPoS",
              "ResourceName": "DINE-AzMonIoTPoS",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonIoTPoS",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Devices/provisioningServices"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Devices/provisioningServices/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "DeviceOperations",
                                      "enabled": true
                                    },
                                    {
                                      "category": "ServiceOperations",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonKV",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonKV",
              "ResourceName": "DINE-AzMonKV",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonKV",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.KeyVault/vaults"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "vaultName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.KeyVault/vaults/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('vaultName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "AuditEvent",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "vaultName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonLB",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonLB",
              "ResourceName": "DINE-AzMonLB",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonLB",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/loadBalancers"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "lbName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/loadBalancers/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('lbName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "LoadBalancerAlertEvent",
                                      "enabled": true
                                    },
                                    {
                                      "category": "LoadBalancerProbeHealthStatus",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "lbName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonLogicApp",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonLogicApp",
              "ResourceName": "DINE-AzMonLogicApp",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonLogicApp",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Logic/workflows"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Logic/workflows/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "WorkflowRuntime",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonLogicIA",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonLogicIA",
              "ResourceName": "DINE-AzMonLogicIA",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonLogicIA",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Logic/integrationAccounts"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Logic/integrationAccounts/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "logs": [
                                    {
                                      "category": "IntegrationAccountTrackingEvents",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonMySQL",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonMySQL",
              "ResourceName": "DINE-AzMonMySQL",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonMySQL",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.DBforMySQL/servers"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.DBforMySQL/servers/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonNIC",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonNIC",
              "ResourceName": "DINE-AzMonNIC",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonNIC",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/networkInterfaces"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/networkInterfaces/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonNsg",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonNsg",
              "ResourceName": "DINE-AzMonNsg",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonNsg",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/networkSecurityGroups"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "nsgName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('nsgName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "logs": [
                                    {
                                      "category": "NetworkSecurityGroupEvent",
                                      "enabled": true
                                    },
                                    {
                                      "category": "NetworkSecurityGroupRuleCounter",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "nsgName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonPiP",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonPiP",
              "ResourceName": "DINE-AzMonPiP",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonPiP",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/publicIpAddresses"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "publicIpName": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/publicIpAddresses/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('publicIpName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "timeGrain": "PT1M",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "DDoSProtectionNotifications",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "publicIpName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonPostGresSQL",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonPostGresSQL",
              "ResourceName": "DINE-AzMonPostGresSQL",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonPostGresSQL",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.DBforPostgreSQL/servers"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "PostgreSQLBackupEvents",
                                      "enabled": true
                                    },
                                    {
                                      "category": "PostgreSQLLogs",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonRedis",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonRedis",
              "ResourceName": "DINE-AzMonRedis",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonRedis",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Cache/redis"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Cache/redis/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonRelay",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonRelay",
              "ResourceName": "DINE-AzMonRelay",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonRelay",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Relay/namespaces"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Relay/namespaces/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonSB",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSB",
              "ResourceName": "DINE-AzMonSB",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSB",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.ServiceBus/namespaces"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "sbName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.ServiceBus/namespaces/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('sbName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "OperationalLogs",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "sbName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonSearch",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSearch",
              "ResourceName": "DINE-AzMonSearch",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSearch",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Search/searchServices"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Search/searchServices/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "OperationLogs",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonSignalR",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSignalR",
              "ResourceName": "DINE-AzMonSignalR",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSignalR",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.SignalRService/SignalR"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.SignalRService/SignalR/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonSql",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSql",
              "ResourceName": "DINE-AzMonSql",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSql",
              "Properties": {
                "Description": null,
                "DisplayName": "DINE-AzMonSql",
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Sql/servers/databases"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "sqlServerName": {
                                "type": "string"
                              },
                              "databaseName": {
                                "type": "string",
                                "metadata": {
                                  "description": "Name of the SQL database to create"
                                }
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Sql/servers/databases/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('sqlServerName'), '/', parameters('databaseName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "timeGrain": "PT1M",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "QueryStoreRuntimeStatistics",
                                      "enabled": true
                                    },
                                    {
                                      "category": "QueryStoreWaitStatistics",
                                      "enabled": true
                                    },
                                    {
                                      "category": "Errors",
                                      "enabled": true
                                    },
                                    {
                                      "category": "DatabaseWaitStatistics",
                                      "enabled": true
                                    },
                                    {
                                      "category": "Blocks",
                                      "enabled": true
                                    },
                                    {
                                      "category": "SQLInsights",
                                      "enabled": true
                                    },
                                    {
                                      "category": "Audit",
                                      "enabled": true
                                    },
                                    {
                                      "category": "SQLSecurityAuditEvents",
                                      "enabled": true
                                    },
                                    {
                                      "category": "Timeouts",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "sqlServerName": {
                              "value": "[first(split(field('fullname'),'/'))]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "databaseName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonSqlAS",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSqlAS",
              "ResourceName": "DINE-AzMonSqlAS",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSqlAS",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.AnalysisServices/servers"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "analysisName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.AnalysisServices/servers/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('analysisName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "Engine",
                                      "enabled": true
                                    },
                                    {
                                      "category": "Service",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "analysisName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonTM",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonTM",
              "ResourceName": "DINE-AzMonTM",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonTM",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/trafficManagerProfiles"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "ProbeHealthStatusEvents",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonVNet",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonVNet",
              "ResourceName": "DINE-AzMonVNet",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonVNet",
              "Properties": {
                "Description": "Connects Azure VNets to Azure Monitor Log Analytics for the gathering of metric and logs",
                "DisplayName": "DINE-AzMonVNet",
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analytics workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/virtualNetworks"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "existenceCondition": {
                        "allOf": [
                          {
                            "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                            "equals": "true"
                          },
                          {
                            "field": "Microsoft.Insights/diagnosticSettings/workspaceId",
                            "equals": "[parameters('logAnalytics')]"
                          }
                        ]
                      },
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/virtualNetworks/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "logs": [
                                    {
                                      "category": "VMProtectionAlerts",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonVNetGW",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonVNetGW",
              "ResourceName": "DINE-AzMonVNetGW",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonVNetGW",
              "Properties": {
                "Description": "Connects Azure VNet Gateways to Azure Monitor Log Analytics for the gathering of metric and logs",
                "DisplayName": "DINE-AzMonVNetGW",
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analytics workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/virtualNetworkGateways"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "existenceCondition": {
                        "allOf": [
                          {
                            "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                            "equals": "true"
                          },
                          {
                            "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                            "equals": "true"
                          },
                          {
                            "field": "Microsoft.Insights/diagnosticSettings/workspaceId",
                            "equals": "[parameters('logAnalytics')]"
                          }
                        ]
                      },
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ],
                                  "logs": [
                                    {
                                      "category": "GatewayDiagnosticLog",
                                      "enabled": true
                                    },
                                    {
                                      "category": "IKEDiagnosticLog",
                                      "enabled": true
                                    },
                                    {
                                      "category": "P2SDiagnosticLog",
                                      "enabled": true
                                    },
                                    {
                                      "category": "RouteDiagnosticLog",
                                      "enabled": true
                                    },
                                    {
                                      "category": "RouteDiagnosticLog",
                                      "enabled": true
                                    },
                                    {
                                      "category": "TunnelDiagnosticLog",
                                      "enabled": true
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-AzMonWebSites",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonWebSites",
              "ResourceName": "DINE-AzMonWebSites",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonWebSites",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "description": "Select the Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Web/sites"
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Insights/diagnosticSettings",
                      "name": "setByPolicy",
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "resourceName": {
                                "type": "string"
                              },
                              "logAnalytics": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              }
                            },
                            "variables": {},
                            "resources": [
                              {
                                "type": "Microsoft.Web/sites/providers/diagnosticSettings",
                                "apiVersion": "2017-05-01-preview",
                                "name": "[concat(parameters('resourceName'), '/', 'Microsoft.Insights/setByPolicy')]",
                                "location": "[parameters('location')]",
                                "dependsOn": [],
                                "properties": {
                                  "workspaceId": "[parameters('logAnalytics')]",
                                  "metrics": [
                                    {
                                      "category": "AllMetrics",
                                      "enabled": true,
                                      "retentionPolicy": {
                                        "enabled": false,
                                        "days": 0
                                      }
                                    }
                                  ]
                                }
                              }
                            ],
                            "outputs": {}
                          },
                          "parameters": {
                            "logAnalytics": {
                              "value": "[parameters('logAnalytics')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "resourceName": {
                              "value": "[field('name')]"
                            }
                          }
                        }
                      },
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ]
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-NetWatcher",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-NetWatcher",
              "ResourceName": "DINE-NetWatcher",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-NetWatcher",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {},
                "PolicyRule": {
                  "if": {
                    "field": "type",
                    "equals": "Microsoft.Network/virtualNetworks"
                  },
                  "then": {
                    "effect": "DeployIfNotExists",
                    "details": {
                      "type": "Microsoft.Network/networkWatchers",
                      "resourceGroupName": "networkWatcherRG",
                      "existenceCondition": {
                        "field": "location",
                        "equals": "[field('location')]"
                      },
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "location": {
                                "type": "string"
                              }
                            },
                            "resources": [
                              {
                                "apiVersion": "2016-09-01",
                                "type": "Microsoft.Network/networkWatchers",
                                "name": "[concat('networkWacher_', parameters('location'))]",
                                "location": "[parameters('location')]"
                              }
                            ]
                          },
                          "parameters": {
                            "location": {
                              "value": "[field('location')]"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-Windows-ADDJ-OMS",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-Windows-ADDJ-OMS",
              "ResourceName": "DINE-Windows-ADDJ-OMS",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-Windows-ADDJ-OMS",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "keyVaultRef": {
                    "type": "String",
                    "metadata": {
                      "description": "Keyvault Resource ID",
                      "displayName": "keyVaultRef",
                      "strongType": "KeyVault"
                    },
                    "defaultValue": "/subscriptions/92b1b98d-6d0f-4252-91cf-e7dfdaf43a38/resourceGroups/m2-ne-prod-hub1-kv-rg/providers/Microsoft.KeyVault/vaults/m2-ne-prod-hub1-kv"
                  },
                  "domainJoinUserName": {
                    "type": "String",
                    "metadata": {
                      "description": "username secret name"
                    },
                    "defaultValue": "domainjoin-username1"
                  },
                  "domainFQDN": {
                    "type": "String",
                    "metadata": {
                      "description": "domain FQDN"
                    },
                    "defaultValue": "m2-adds.local"
                  },
                  "domainJoinUserPassword": {
                    "type": "String",
                    "metadata": {
                      "description": "passord sercret name"
                    },
                    "defaultValue": "domainjoin-password"
                  },
                  "ouPath": {
                    "type": "String",
                    "metadata": {
                      "description": "OU Path"
                    },
                    "defaultValue": ""
                  },
                  "logAnalyticsEurope": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analytics workspace for Europe Region",
                      "description": "Select Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    },
                    "defaultValue": "/subscriptions/4b7561c1-24a7-468f-8b80-bf79cc29d48b/resourceGroups/m2-oms-europe/providers/Microsoft.OperationalInsights/workspaces/m2-oms-westeurope"
                  },
                  "logAnalyticsNorthAmerica": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analytics workspace for North America Region",
                      "description": "Select Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    },
                    "defaultValue": "/subscriptions/4b7561c1-24a7-468f-8b80-bf79cc29d48b/resourceGroups/m2-oms-northamerica/providers/Microsoft.OperationalInsights/workspaces/m2-oms-northamerica"
                  },
                  "serviceMap": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Select Yes or No if you are using Service Map",
                      "description": "By selecting 'Yes', Service Map extension will be installed"
                    },
                    "allowedValues": [
                      "Yes",
                      "No"
                    ],
                    "defaultValue": "Yes"
                  }
                },
                "PolicyRule": {
                  "if": {
                    "allOf": [
                      {
                        "field": "type",
                        "equals": "Microsoft.Compute/virtualMachines"
                      },
                      {
                        "field": "Microsoft.Compute/imagePublisher",
                        "equals": "MicrosoftWindowsServer"
                      },
                      {
                        "field": "Microsoft.Compute/imageOffer",
                        "equals": "WindowsServer"
                      },
                      {
                        "field": "Microsoft.Compute/imageSKU",
                        "in": [
                          "2008-R2-SP1",
                          "2008-R2-SP1-smalldisk",
                          "2012-Datacenter",
                          "2012-Datacenter-smalldisk",
                          "2012-R2-Datacenter",
                          "2012-R2-Datacenter-smalldisk",
                          "2016-Datacenter",
                          "2016-Datacenter-Server-Core",
                          "2016-Datacenter-Server-Core-smalldisk",
                          "2016-Datacenter-smalldisk",
                          "2016-Datacenter-with-Containers",
                          "2016-Datacenter-with-RDSH"
                        ]
                      }
                    ]
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "name": "policy1",
                      "type": "Microsoft.Compute/virtualMachines/extensions",
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ],
                      "existenceCondition": {
                        "allOf": [
                          {
                            "field": "Microsoft.Compute/virtualMachines/extensions/type",
                            "equals": "JsonADDomainExtension"
                          },
                          {
                            "field": "Microsoft.Compute/virtualMachines/extensions/publisher",
                            "equals": "Microsoft.Compute"
                          },
                          {
                            "field": "Microsoft.Compute/virtualMachines/extensions/type",
                            "equals": "MicrosoftMonitoringAgent"
                          },
                          {
                            "field": "Microsoft.Compute/virtualMachines/extensions/publisher",
                            "equals": "Microsoft.EnterpriseCloud.Monitoring"
                          }
                        ]
                      },
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "vmName": {
                                "type": "string",
                                "minLength": 1,
                                "metadata": {
                                  "description": "List of virtual machines to be domain joined, if using multiple VMs, make their names comma separate. E.g. VM01, VM02, VM03."
                                }
                              },
                              "location": {
                                "type": "string",
                                "metadata": {
                                  "description": "Location name of the virtual machine"
                                }
                              },
                              "domainJoinUserName": {
                                "type": "string",
                                "metadata": {
                                  "description": "Domain NetBiosName plus User name of a domain user with sufficient rights to perfom domain join operation. E.g. domain slash username"
                                }
                              },
                              "domainJoinUserPassword": {
                                "type": "securestring",
                                "metadata": {
                                  "description": "Domain user password"
                                }
                              },
                              "domainFQDN": {
                                "type": "string",
                                "metadata": {
                                  "description": "Domain FQDN where the virtual machine will be joined"
                                }
                              },
                              "ouPath": {
                                "type": "string",
                                "defaultValue": "",
                                "metadata": {
                                  "description": "Specifies an organizational unit (OU) for the domain account. Enter the full distinguished name of the OU in quotation marks = testOU;DC = domain;DC = Domain;DC = com "
                                }
                              },
                              "keyVaultRef": {
                                "type": "string",
                                "defaultValue": "/subscriptions/926ab52d-a877-4db3-b0f9-2e9f8ecbe4c4/resourceGroups/bp-shared-services/providers/Microsoft.KeyVault/vaults/bp-shared-services",
                                "metadata": {
                                  "description": "Keyvault Resource ID",
                                  "displayName": "keyVaultRef"
                                }
                              },
                              "logAnalyticsEurope": {
                                "type": "string"
                              },
                              "logAnalyticsNorthAmerica": {
                                "type": "string"
                              },
                              "serviceMap": {
                                "type": "string"
                              }
                            },
                            "variables": {
                              "domainJoinOptions": 3,
                              "vmName": "[parameters('vmName')]"
                            },
                            "resources": [
                              {
                                "apiVersion": "2017-05-10",
                                "name": "[concat(parameters('vmName'),'blockrdp')]",
                                "type": "Microsoft.Resources/deployments",
                                "properties": {
                                  "mode": "Incremental",
                                  "template": {
                                    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                    "contentVersion": "1.0.0.0",
                                    "parameters": {
                                      "vmName": {
                                        "type": "string",
                                        "minLength": 1,
                                        "metadata": {
                                          "description": "List of virtual machines to be domain joined, if using multiple VMs, make their names comma separate. E.g. VM01, VM02, VM03."
                                        }
                                      }
                                    },
                                    "variables": {
                                      "domainJoinOptions": 3,
                                      "vmName": "[parameters('vmName')]"
                                    },
                                    "resources": [
                                      {
                                        "apiVersion": "2017-03-01",
                                        "type": "Microsoft.Network/networkSecurityGroups",
                                        "name": "[concat(parameters('vmName'),'NSG')]",
                                        "location": "[resourceGroup().location]",
                                        "properties": {
                                          "securityRules": [
                                            {
                                              "name": "rdp",
                                              "properties": {
                                                "protocol": "Tcp",
                                                "sourcePortRange": "*",
                                                "destinationPortRange": "3389",
                                                "sourceAddressPrefix": "*",
                                                "destinationAddressPrefix": "*",
                                                "access": "Deny",
                                                "priority": 1000,
                                                "direction": "Inbound",
                                                "sourcePortRanges": [],
                                                "destinationPortRanges": [],
                                                "sourceAddressPrefixes": [],
                                                "destinationAddressPrefixes": []
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    ],
                                    "outputs": {}
                                  },
                                  "parameters": {
                                    "vmName": {
                                      "value": "[parameters('vmName')]"
                                    }
                                  }
                                }
                              },
                              {
                                "comments": "Join domain - JsonADDomainExtension",
                                "apiVersion": "2015-06-15",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "name": "[concat(variables('vmName'),'/joindomain')]",
                                "location": "[resourceGroup().location]",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Resources/deployments', concat(parameters('vmName'),'blockrdp'))]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.Compute",
                                  "type": "JsonADDomainExtension",
                                  "typeHandlerVersion": "1.3",
                                  "autoUpgradeMinorVersion": true,
                                  "settings": {
                                    "Name": "[parameters('domainFQDN')]",
                                    "User": "[parameters('domainJoinUserName')]",
                                    "Restart": "true",
                                    "Options": "[variables('domainJoinOptions')]",
                                    "OUPath": "[parameters('ouPath')]"
                                  },
                                  "protectedSettings": {
                                    "Password": "[parameters('domainJoinUserPassword')]"
                                  }
                                }
                              },
                              {
                                "condition": "[equals(parameters('location'),'northeurope')]",
                                "name": "[concat(parameters('vmName'),'/omsPolicy-ne')]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "location": "[parameters('location')]",
                                "apiVersion": "2017-03-30",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions', variables('vmName') ,  concat('joindomain'))]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.EnterpriseCloud.Monitoring",
                                  "type": "MicrosoftMonitoringAgent",
                                  "typeHandlerVersion": "1.0",
                                  "autoUpgradeMinorVersion": true,
                                  "settings": {
                                    "workspaceId": "[reference(parameters('logAnalyticsEurope'), '2015-11-01-preview').customerId]"
                                  },
                                  "protectedSettings": {
                                    "workspaceKey": "[listKeys(parameters('logAnalyticsEurope'), '2015-11-01-preview').primarySharedKey]"
                                  }
                                }
                              },
                              {
                                "condition": "[and(equals(parameters('serviceMap'), 'Yes'),equals(parameters('location'),'northeurope'))]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "name": "[concat(parameters('vmName'),'/serviceMapPolicy-ne')]",
                                "apiVersion": "2017-03-30",
                                "location": "[parameters('location')]",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions/', parameters('vmName'), 'omsPolicy-ne')]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.Azure.Monitoring.DependencyAgent",
                                  "type": "DependencyAgentWindows",
                                  "typeHandlerVersion": "9.1",
                                  "autoUpgradeMinorVersion": true
                                }
                              },
                              {
                                "condition": "[equals(parameters('location'),'northcentralus')]",
                                "name": "[concat(parameters('vmName'),'/omsPolicy-eastus')]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "location": "[parameters('location')]",
                                "apiVersion": "2017-03-30",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions', variables('vmName') ,  concat('joindomain'))]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.EnterpriseCloud.Monitoring",
                                  "type": "MicrosoftMonitoringAgent",
                                  "typeHandlerVersion": "1.0",
                                  "autoUpgradeMinorVersion": true,
                                  "settings": {
                                    "workspaceId": "[reference(parameters('logAnalyticsNorthAmerica'), '2015-11-01-preview').customerId]"
                                  },
                                  "protectedSettings": {
                                    "workspaceKey": "[listKeys(parameters('logAnalyticsNorthAmerica'), '2015-11-01-preview').primarySharedKey]"
                                  }
                                }
                              },
                              {
                                "condition": "[and(equals(parameters('serviceMap'), 'Yes'),equals(parameters('location'),'northcentralus'))]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "name": "[concat(parameters('vmName'),'/bp-serviceMapPolicy-ncus')]",
                                "apiVersion": "2017-03-30",
                                "location": "[parameters('location')]",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions/', parameters('vmName'), 'omsPolicy-eastus')]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.Azure.Monitoring.DependencyAgent",
                                  "type": "DependencyAgentWindows",
                                  "typeHandlerVersion": "9.1",
                                  "autoUpgradeMinorVersion": true
                                }
                              },
                              {
                                "apiVersion": "2017-05-10",
                                "name": "[concat(parameters('vmName'),'enablerdp')]",
                                "type": "Microsoft.Resources/deployments",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions', variables('vmName') ,  concat('joindomain'))]"
                                ],
                                "properties": {
                                  "mode": "Incremental",
                                  "template": {
                                    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                    "contentVersion": "1.0.0.0",
                                    "parameters": {
                                      "vmName": {
                                        "type": "string",
                                        "minLength": 1,
                                        "metadata": {
                                          "description": "List of virtual machines to be domain joined, if using multiple VMs, make their names comma separate. E.g. VM01, VM02, VM03."
                                        }
                                      }
                                    },
                                    "variables": {
                                      "domainJoinOptions": 3,
                                      "vmName": "[parameters('vmName')]"
                                    },
                                    "resources": [
                                      {
                                        "apiVersion": "2017-03-01",
                                        "type": "Microsoft.Network/networkSecurityGroups",
                                        "name": "[concat(parameters('vmName'),'NSG')]",
                                        "location": "[resourceGroup().location]",
                                        "properties": {
                                          "securityRules": [
                                            {
                                              "name": "rdp",
                                              "properties": {
                                                "protocol": "Tcp",
                                                "sourcePortRange": "*",
                                                "destinationPortRange": "3389",
                                                "sourceAddressPrefix": "*",
                                                "destinationAddressPrefix": "*",
                                                "access": "Allow",
                                                "priority": 1000,
                                                "direction": "Inbound",
                                                "sourcePortRanges": [],
                                                "destinationPortRanges": [],
                                                "sourceAddressPrefixes": [],
                                                "destinationAddressPrefixes": []
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    ],
                                    "outputs": {}
                                  },
                                  "parameters": {
                                    "vmName": {
                                      "value": "[parameters('vmName')]"
                                    }
                                  }
                                }
                              }
                            ],
                            "outputs": {
                              "policy": {
                                "type": "string",
                                "value": "[concat('Enabled AD Domain Join for Windows VM', ': ', parameters('vmName'))]"
                              }
                            }
                          },
                          "parameters": {
                            "vmName": {
                              "value": "[field('name')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "domainJoinUserName": {
                              "reference": {
                                "keyVault": {
                                  "id": "[parameters('keyVaultRef')]"
                                },
                                "secretName": "[parameters('domainJoinUserName')]"
                              }
                            },
                            "domainJoinUserPassword": {
                              "reference": {
                                "keyVault": {
                                  "id": "[parameters('keyVaultRef')]"
                                },
                                "secretName": "[parameters('domainJoinUserPassword')]"
                              }
                            },
                            "ouPath": {
                              "value": "[parameters('ouPath')]"
                            },
                            "domainFQDN": {
                              "value": "[parameters('domainFQDN')]"
                            },
                            "keyVaultRef": {
                              "value": "[parameters('keyVaultRef')]"
                            },
                            "serviceMap": {
                              "value": "[parameters('serviceMap')]"
                            },
                            "logAnalyticsEurope": {
                              "value": "[parameters('logAnalyticsEurope')]"
                            },
                            "logAnalyticsNorthAmerica": {
                              "value": "[parameters('logAnalyticsNorthAmerica')]"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-Windows-Antimalware",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-Windows-Antimalware",
              "ResourceName": "DINE-Windows-Antimalware",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-Windows-Antimalware",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "keyVaultRef": {
                    "type": "String",
                    "metadata": {
                      "description": "Keyvault Resource ID",
                      "displayName": "keyVaultRef",
                      "strongType": "KeyVault"
                    },
                    "defaultValue": "/subscriptions/bb81881b-d6a7-4590-b14e-bb3c575e42c5/resourceGroups/bp-ne-kv/providers/Microsoft.KeyVault/vaults/bp-ne-mgmtkv"
                  },
                  "domainJoinUserName": {
                    "type": "String",
                    "metadata": {
                      "description": "username secret name"
                    },
                    "defaultValue": "domainjoin-username2"
                  },
                  "domainFQDN": {
                    "type": "String",
                    "metadata": {
                      "description": "domain FQDN"
                    },
                    "defaultValue": "bpupstream.local"
                  },
                  "domainJoinUserPassword": {
                    "type": "String",
                    "metadata": {
                      "description": "passord sercret name"
                    },
                    "defaultValue": "domainjoin-password"
                  },
                  "logAnalyticsEurope": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analytics workspace for Europe Region",
                      "description": "Select Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  },
                  "logAnalyticsNorthAmerica": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analytics workspace for North America Region",
                      "description": "Select Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  },
                  "serviceMap": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Select Yes or No if you are using Service Map",
                      "description": "By selecting 'Yes', Service Map extension will be installed"
                    },
                    "allowedValues": [
                      "Yes",
                      "No"
                    ]
                  }
                },
                "PolicyRule": {
                  "if": {
                    "allOf": [
                      {
                        "field": "type",
                        "equals": "Microsoft.Compute/virtualMachines"
                      },
                      {
                        "field": "Microsoft.Compute/imagePublisher",
                        "equals": "MicrosoftWindowsServer"
                      },
                      {
                        "field": "Microsoft.Compute/imageOffer",
                        "equals": "WindowsServer"
                      },
                      {
                        "field": "Microsoft.Compute/imageSKU",
                        "in": [
                          "2008-R2-SP1",
                          "2008-R2-SP1-smalldisk",
                          "2012-Datacenter",
                          "2012-Datacenter-smalldisk",
                          "2012-R2-Datacenter",
                          "2012-R2-Datacenter-smalldisk",
                          "2016-Datacenter",
                          "2016-Datacenter-Server-Core",
                          "2016-Datacenter-Server-Core-smalldisk",
                          "2016-Datacenter-smalldisk",
                          "2016-Datacenter-with-Containers",
                          "2016-Datacenter-with-RDSH"
                        ]
                      }
                    ]
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "name": "policy1",
                      "type": "Microsoft.Compute/virtualMachines/extensions",
                      "existenceCondition": {
                        "allOf": [
                          {
                            "field": "Microsoft.Compute/virtualMachines/extensions/type",
                            "equals": "JsonADDomainExtension"
                          },
                          {
                            "field": "Microsoft.Compute/virtualMachines/extensions/publisher",
                            "equals": "Microsoft.Compute"
                          },
                          {
                            "field": "Microsoft.Compute/virtualMachines/extensions/type",
                            "equals": "MicrosoftMonitoringAgent"
                          },
                          {
                            "field": "Microsoft.Compute/virtualMachines/extensions/publisher",
                            "equals": "Microsoft.EnterpriseCloud.Monitoring"
                          }
                        ]
                      },
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "vmName": {
                                "type": "string",
                                "minLength": 1,
                                "metadata": {
                                  "description": "List of virtual machines to be domain joined, if using multiple VMs, make their names comma separate. E.g. VM01, VM02, VM03."
                                }
                              },
                              "location": {
                                "type": "string",
                                "metadata": {
                                  "description": "Location name of the virtual machine"
                                }
                              },
                              "domainJoinUserName": {
                                "type": "string",
                                "metadata": {
                                  "description": "Domain NetBiosName plus User name of a domain user with sufficient rights to perfom domain join operation. E.g. domain slash username"
                                }
                              },
                              "domainJoinUserPassword": {
                                "type": "securestring",
                                "metadata": {
                                  "description": "Domain user password"
                                }
                              },
                              "domainFQDN": {
                                "type": "string",
                                "metadata": {
                                  "description": "Domain FQDN where the virtual machine will be joined"
                                }
                              },
                              "ouPath": {
                                "type": "string",
                                "defaultValue": "",
                                "metadata": {
                                  "description": "Specifies an organizational unit (OU) for the domain account. Enter the full distinguished name of the OU in quotation marks = testOU;DC = domain;DC = Domain;DC = com "
                                }
                              },
                              "keyVaultRef": {
                                "type": "string",
                                "defaultValue": "/subscriptions/926ab52d-a877-4db3-b0f9-2e9f8ecbe4c4/resourceGroups/bp-shared-services/providers/Microsoft.KeyVault/vaults/bp-shared-services",
                                "metadata": {
                                  "description": "Keyvault Resource ID",
                                  "displayName": "keyVaultRef"
                                }
                              },
                              "logAnalyticsEurope": {
                                "type": "string"
                              },
                              "logAnalyticsNorthAmerica": {
                                "type": "string"
                              },
                              "serviceMap": {
                                "type": "string"
                              }
                            },
                            "variables": {
                              "domainJoinOptions": 3,
                              "vmName": "[parameters('vmName')]"
                            },
                            "resources": [
                              {
                                "apiVersion": "2017-05-10",
                                "name": "[concat(parameters('vmName'),'bp-blockrdp')]",
                                "type": "Microsoft.Resources/deployments",
                                "properties": {
                                  "mode": "Incremental",
                                  "template": {
                                    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                    "contentVersion": "1.0.0.0",
                                    "parameters": {
                                      "vmName": {
                                        "type": "string",
                                        "minLength": 1,
                                        "metadata": {
                                          "description": "List of virtual machines to be domain joined, if using multiple VMs, make their names comma separate. E.g. VM01, VM02, VM03."
                                        }
                                      }
                                    },
                                    "variables": {
                                      "domainJoinOptions": 3,
                                      "vmName": "[parameters('vmName')]"
                                    },
                                    "resources": [
                                      {
                                        "apiVersion": "2017-03-01",
                                        "type": "Microsoft.Network/networkSecurityGroups",
                                        "name": "[concat(parameters('vmName'),'NSG')]",
                                        "location": "[resourceGroup().location]",
                                        "properties": {
                                          "securityRules": [
                                            {
                                              "name": "rdp",
                                              "properties": {
                                                "protocol": "Tcp",
                                                "sourcePortRange": "*",
                                                "destinationPortRange": "3389",
                                                "sourceAddressPrefix": "*",
                                                "destinationAddressPrefix": "*",
                                                "access": "Deny",
                                                "priority": 1000,
                                                "direction": "Inbound",
                                                "sourcePortRanges": [],
                                                "destinationPortRanges": [],
                                                "sourceAddressPrefixes": [],
                                                "destinationAddressPrefixes": []
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    ],
                                    "outputs": {}
                                  },
                                  "parameters": {
                                    "vmName": {
                                      "value": "[parameters('vmName')]"
                                    }
                                  }
                                }
                              },
                              {
                                "comments": "Join domain - JsonADDomainExtension",
                                "apiVersion": "2015-06-15",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "name": "[concat(variables('vmName'),'/bp-joindomain')]",
                                "location": "[resourceGroup().location]",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Resources/deployments', concat(parameters('vmName'),'bp-blockrdp'))]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.Compute",
                                  "type": "JsonADDomainExtension",
                                  "typeHandlerVersion": "1.3",
                                  "autoUpgradeMinorVersion": true,
                                  "settings": {
                                    "Name": "[parameters('domainFQDN')]",
                                    "User": "[parameters('domainJoinUserName')]",
                                    "Restart": "true",
                                    "Options": "[variables('domainJoinOptions')]",
                                    "OUPath": "[parameters('ouPath')]"
                                  },
                                  "protectedSettings": {
                                    "Password": "[parameters('domainJoinUserPassword')]"
                                  }
                                }
                              },
                              {
                                "condition": "[equals(parameters('location'),'northeurope')]",
                                "name": "[concat(parameters('vmName'),'/bp-omsPolicy-ne')]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "location": "[parameters('location')]",
                                "apiVersion": "2017-03-30",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions', variables('vmName') ,  concat('bp-joindomain'))]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.EnterpriseCloud.Monitoring",
                                  "type": "MicrosoftMonitoringAgent",
                                  "typeHandlerVersion": "1.0",
                                  "autoUpgradeMinorVersion": true,
                                  "settings": {
                                    "workspaceId": "[reference(parameters('logAnalyticsEurope'), '2015-11-01-preview').customerId]"
                                  },
                                  "protectedSettings": {
                                    "workspaceKey": "[listKeys(parameters('logAnalyticsEurope'), '2015-11-01-preview').primarySharedKey]"
                                  }
                                }
                              },
                              {
                                "condition": "[and(equals(parameters('serviceMap'), 'Yes'),equals(parameters('location'),'northeurope'))]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "name": "[concat(parameters('vmName'),'/bp-serviceMapPolicy-ne')]",
                                "apiVersion": "2017-03-30",
                                "location": "[parameters('location')]",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions/', parameters('vmName'), 'bp-omsPolicy-ne')]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.Azure.Monitoring.DependencyAgent",
                                  "type": "DependencyAgentWindows",
                                  "typeHandlerVersion": "9.1",
                                  "autoUpgradeMinorVersion": true
                                }
                              },
                              {
                                "condition": "[equals(parameters('location'),'northcentralus')]",
                                "name": "[concat(parameters('vmName'),'/bp-omsPolicy-ncus')]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "location": "[parameters('location')]",
                                "apiVersion": "2017-03-30",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions', variables('vmName') ,  concat('bp-joindomain'))]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.EnterpriseCloud.Monitoring",
                                  "type": "MicrosoftMonitoringAgent",
                                  "typeHandlerVersion": "1.0",
                                  "autoUpgradeMinorVersion": true,
                                  "settings": {
                                    "workspaceId": "[reference(parameters('logAnalyticsNorthAmerica'), '2015-11-01-preview').customerId]"
                                  },
                                  "protectedSettings": {
                                    "workspaceKey": "[listKeys(parameters('logAnalyticsNorthAmerica'), '2015-11-01-preview').primarySharedKey]"
                                  }
                                }
                              },
                              {
                                "condition": "[and(equals(parameters('serviceMap'), 'Yes'),equals(parameters('location'),'northcentralus'))]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "name": "[concat(parameters('vmName'),'/bp-serviceMapPolicy-ncus')]",
                                "apiVersion": "2017-03-30",
                                "location": "[parameters('location')]",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions/', parameters('vmName'), 'bp-omsPolicy-ncus')]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.Azure.Monitoring.DependencyAgent",
                                  "type": "DependencyAgentWindows",
                                  "typeHandlerVersion": "9.1",
                                  "autoUpgradeMinorVersion": true
                                }
                              },
                              {
                                "apiVersion": "2017-05-10",
                                "name": "[concat(parameters('vmName'),'bp-enablerdp')]",
                                "type": "Microsoft.Resources/deployments",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions', variables('vmName') ,  concat('bp-joindomain'))]"
                                ],
                                "properties": {
                                  "mode": "Incremental",
                                  "template": {
                                    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                                    "contentVersion": "1.0.0.0",
                                    "parameters": {
                                      "vmName": {
                                        "type": "string",
                                        "minLength": 1,
                                        "metadata": {
                                          "description": "List of virtual machines to be domain joined, if using multiple VMs, make their names comma separate. E.g. VM01, VM02, VM03."
                                        }
                                      }
                                    },
                                    "variables": {
                                      "domainJoinOptions": 3,
                                      "vmName": "[parameters('vmName')]"
                                    },
                                    "resources": [
                                      {
                                        "apiVersion": "2017-03-01",
                                        "type": "Microsoft.Network/networkSecurityGroups",
                                        "name": "[concat(parameters('vmName'),'NSG')]",
                                        "location": "[resourceGroup().location]",
                                        "properties": {
                                          "securityRules": [
                                            {
                                              "name": "rdp",
                                              "properties": {
                                                "protocol": "Tcp",
                                                "sourcePortRange": "*",
                                                "destinationPortRange": "3389",
                                                "sourceAddressPrefix": "*",
                                                "destinationAddressPrefix": "*",
                                                "access": "Allow",
                                                "priority": 1000,
                                                "direction": "Inbound",
                                                "sourcePortRanges": [],
                                                "destinationPortRanges": [],
                                                "sourceAddressPrefixes": [],
                                                "destinationAddressPrefixes": []
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    ],
                                    "outputs": {}
                                  },
                                  "parameters": {
                                    "vmName": {
                                      "value": "[parameters('vmName')]"
                                    }
                                  }
                                }
                              }
                            ],
                            "outputs": {
                              "policy": {
                                "type": "string",
                                "value": "[concat('Enabled AD Domain Join for Windows VM', ': ', parameters('vmName'))]"
                              }
                            }
                          },
                          "parameters": {
                            "vmName": {
                              "value": "[field('name')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "domainJoinUserName": {
                              "reference": {
                                "keyVault": {
                                  "id": "[parameters('keyVaultRef')]"
                                },
                                "secretName": "[parameters('domainJoinUserName')]"
                              }
                            },
                            "domainJoinUserPassword": {
                              "reference": {
                                "keyVault": {
                                  "id": "[parameters('keyVaultRef')]"
                                },
                                "secretName": "[parameters('domainJoinUserPassword')]"
                              }
                            },
                            "domainFQDN": {
                              "value": "[parameters('domainFQDN')]"
                            },
                            "keyVaultRef": {
                              "value": "[parameters('keyVaultRef')]"
                            },
                            "serviceMap": {
                              "value": "[parameters('serviceMap')]"
                            },
                            "logAnalyticsEurope": {
                              "value": "[parameters('logAnalyticsEurope')]"
                            },
                            "logAnalyticsNorthAmerica": {
                              "value": "[parameters('logAnalyticsNorthAmerica')]"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            {
              "Name": "DINE-Windows-Oms",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-Windows-Oms",
              "ResourceName": "DINE-Windows-Oms",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-Windows-Oms",
              "Properties": {
                "Description": null,
                "DisplayName": "DINE-Windows-Oms",
                "Mode": "All",
                "Parameters": {
                  "logAnalyticsEurope": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analytics workspace for Europe Region",
                      "description": "Select Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  },
                  "logAnalyticsNorthAmerica": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analytics workspace for North America Region",
                      "description": "Select Log Analytics workspace from dropdown list",
                      "strongType": "omsWorkspace"
                    }
                  },
                  "serviceMap": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Select Yes or No if you are using Service Map",
                      "description": "By selecting 'Yes', Service Map extension will be installed"
                    },
                    "allowedValues": [
                      "Yes",
                      "No"
                    ]
                  }
                },
                "PolicyRule": {
                  "if": {
                    "allOf": [
                      {
                        "field": "type",
                        "equals": "Microsoft.Compute/virtualMachines"
                      },
                      {
                        "anyOf": [
                          {
                            "allOf": [
                              {
                                "field": "Microsoft.Compute/imagePublisher",
                                "equals": "MicrosoftWindowsServer"
                              },
                              {
                                "field": "Microsoft.Compute/imageOffer",
                                "equals": "WindowsServer"
                              },
                              {
                                "field": "Microsoft.Compute/imageSKU",
                                "in": [
                                  "2008-R2-SP1",
                                  "2008-R2-SP1-smalldisk",
                                  "2012-Datacenter",
                                  "2012-Datacenter-smalldisk",
                                  "2012-R2-Datacenter",
                                  "2012-R2-Datacenter-smalldisk",
                                  "2016-Datacenter",
                                  "2016-Datacenter-Server-Core",
                                  "2016-Datacenter-Server-Core-smalldisk",
                                  "2016-Datacenter-smalldisk",
                                  "2016-Datacenter-with-Containers",
                                  "2016-Datacenter-with-RDSH"
                                ]
                              }
                            ]
                          },
                          {
                            "allOf": [
                              {
                                "field": "Microsoft.Compute/imagePublisher",
                                "equals": "MicrosoftWindowsServer"
                              },
                              {
                                "field": "Microsoft.Compute/imageOffer",
                                "equals": "WindowsServerSemiAnnual"
                              },
                              {
                                "field": "Microsoft.Compute/imageSKU",
                                "in": [
                                  "Datacenter-Core-1709-smalldisk",
                                  "Datacenter-Core-1709-with-Containers-smalldisk",
                                  "Datacenter-Core-1803-with-Containers-smalldisk"
                                ]
                              }
                            ]
                          },
                          {
                            "allOf": [
                              {
                                "field": "Microsoft.Compute/imagePublisher",
                                "equals": "MicrosoftWindowsServerHPCPack"
                              },
                              {
                                "field": "Microsoft.Compute/imageOffer",
                                "equals": "WindowsServerHPCPack"
                              }
                            ]
                          },
                          {
                            "allOf": [
                              {
                                "field": "Microsoft.Compute/imagePublisher",
                                "equals": "MicrosoftSQLServer"
                              },
                              {
                                "anyOf": [
                                  {
                                    "field": "Microsoft.Compute/imageOffer",
                                    "like": "*-WS2016"
                                  },
                                  {
                                    "field": "Microsoft.Compute/imageOffer",
                                    "like": "*-WS2016-BYOL"
                                  },
                                  {
                                    "field": "Microsoft.Compute/imageOffer",
                                    "like": "*-WS2012R2"
                                  },
                                  {
                                    "field": "Microsoft.Compute/imageOffer",
                                    "like": "*-WS2012R2-BYOL"
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "allOf": [
                              {
                                "field": "Microsoft.Compute/imagePublisher",
                                "equals": "MicrosoftRServer"
                              },
                              {
                                "field": "Microsoft.Compute/imageOffer",
                                "equals": "MLServer-WS2016"
                              }
                            ]
                          },
                          {
                            "allOf": [
                              {
                                "field": "Microsoft.Compute/imagePublisher",
                                "equals": "MicrosoftVisualStudio"
                              },
                              {
                                "field": "Microsoft.Compute/imageOffer",
                                "in": [
                                  "VisualStudio",
                                  "Windows"
                                ]
                              }
                            ]
                          },
                          {
                            "allOf": [
                              {
                                "field": "Microsoft.Compute/imagePublisher",
                                "equals": "MicrosoftDynamicsAX"
                              },
                              {
                                "field": "Microsoft.Compute/imageOffer",
                                "equals": "Dynamics"
                              },
                              {
                                "field": "Microsoft.Compute/imageSKU",
                                "equals": "Pre-Req-AX7-Onebox-U8"
                              }
                            ]
                          },
                          {
                            "allOf": [
                              {
                                "field": "Microsoft.Compute/imagePublisher",
                                "equals": "microsoft-ads"
                              },
                              {
                                "field": "Microsoft.Compute/imageOffer",
                                "equals": "windows-data-science-vm"
                              }
                            ]
                          },
                          {
                            "allOf": [
                              {
                                "field": "Microsoft.Compute/imagePublisher",
                                "equals": "MicrosoftWindowsDesktop"
                              },
                              {
                                "field": "Microsoft.Compute/imageOffer",
                                "equals": "Windows-10"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  "then": {
                    "effect": "deployIfNotExists",
                    "details": {
                      "type": "Microsoft.Compute/virtualMachines/extensions",
                      "roleDefinitionIds": [
                        "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
                      ],
                      "existenceCondition": {
                        "allOf": [
                          {
                            "field": "Microsoft.Compute/virtualMachines/extensions/type",
                            "equals": "MicrosoftMonitoringAgent"
                          },
                          {
                            "field": "Microsoft.Compute/virtualMachines/extensions/publisher",
                            "equals": "Microsoft.EnterpriseCloud.Monitoring"
                          }
                        ]
                      },
                      "deployment": {
                        "properties": {
                          "mode": "incremental",
                          "template": {
                            "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                            "contentVersion": "1.0.0.0",
                            "parameters": {
                              "vmName": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              },
                              "logAnalyticsEurope": {
                                "type": "string"
                              },
                              "logAnalyticsNorthAmerica": {
                                "type": "string"
                              },
                              "serviceMap": {
                                "type": "string"
                              }
                            },
                            "resources": [
                              {
                                "condition": "[equals(parameters('location'),'westeurope')]",
                                "name": "[concat(parameters('vmName'),'/omsPolicy-eu')]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "location": "[parameters('location')]",
                                "apiVersion": "2017-03-30",
                                "properties": {
                                  "publisher": "Microsoft.EnterpriseCloud.Monitoring",
                                  "type": "MicrosoftMonitoringAgent",
                                  "typeHandlerVersion": "1.0",
                                  "autoUpgradeMinorVersion": true,
                                  "settings": {
                                    "workspaceId": "[reference(parameters('logAnalyticsEurope'), '2015-11-01-preview').customerId]"
                                  },
                                  "protectedSettings": {
                                    "workspaceKey": "[listKeys(parameters('logAnalyticsEurope'), '2015-11-01-preview').primarySharedKey]"
                                  }
                                }
                              },
                              {
                                "condition": "[equals(parameters('location'),'eastus')]",
                                "name": "[concat(parameters('vmName'),'/omsPolicy-us')]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "location": "[parameters('location')]",
                                "apiVersion": "2017-03-30",
                                "properties": {
                                  "publisher": "Microsoft.EnterpriseCloud.Monitoring",
                                  "type": "MicrosoftMonitoringAgent",
                                  "typeHandlerVersion": "1.0",
                                  "autoUpgradeMinorVersion": true,
                                  "settings": {
                                    "workspaceId": "[reference(parameters('logAnalyticsNorthAmerica'), '2015-11-01-preview').customerId]"
                                  },
                                  "protectedSettings": {
                                    "workspaceKey": "[listKeys(parameters('logAnalyticsNorthAmerica'), '2015-11-01-preview').primarySharedKey]"
                                  }
                                }
                              },
                              {
                                "condition": "[equals(parameters('serviceMap'), 'Yes')]",
                                "type": "Microsoft.Compute/virtualMachines/extensions",
                                "name": "[concat(parameters('vmName'),'/serviceMapPolicy')]",
                                "apiVersion": "2017-03-30",
                                "location": "[parameters('location')]",
                                "dependsOn": [
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions/', parameters('vmName'), 'omsPolicy-us')]",
                                  "[resourceId('Microsoft.Compute/virtualMachines/extensions/', parameters('vmName'), 'omsPolicy-eu')]"
                                ],
                                "properties": {
                                  "publisher": "Microsoft.Azure.Monitoring.DependencyAgent",
                                  "type": "DependencyAgentWindows",
                                  "typeHandlerVersion": "9.1",
                                  "autoUpgradeMinorVersion": true
                                }
                              }
                            ],
                            "outputs": {
                              "policy": {
                                "type": "string",
                                "value": "[concat('Enabled monitoring for Windows VM', ': ', parameters('vmName'))]"
                              }
                            }
                          },
                          "parameters": {
                            "serviceMap": {
                              "value": "[parameters('serviceMap')]"
                            },
                            "vmName": {
                              "value": "[field('name')]"
                            },
                            "location": {
                              "value": "[field('location')]"
                            },
                            "logAnalyticsEurope": {
                              "value": "[parameters('logAnalyticsEurope')]"
                            },
                            "logAnalyticsNorthAmerica": {
                              "value": "[parameters('logAnalyticsNorthAmerica')]"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            {
              "Name": "Enforce-Naming",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Enforce-Naming",
              "ResourceName": "Enforce-Naming",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Enforce-Naming",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "namePattern": {
                    "type": "String",
                    "metadata": {
                      "description": "Pattern to use for names. Can include *."
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "allOf": [
                      {
                        "not": {
                          "field": "name",
                          "match": "[parameters('namePattern')]"
                        }
                      }
                    ]
                  },
                  "then": {
                    "effect": "audit"
                  }
                }
              }
            },
            {
              "Name": "Enforce-No-ER-peering",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Enforce-No-ER-peering",
              "ResourceName": "Enforce-No-ER-peering",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Enforce-No-ER-peering",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "resourceGroupName": {
                    "type": "String",
                    "metadata": {
                      "description": "Name of the resource group with ER Network",
                      "displayName": "ER Network Resource Group Name",
                      "strongType": "ExistingResourceGroups"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "allOf": [
                      {
                        "field": "type",
                        "equals": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings"
                      },
                      {
                        "field": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id",
                        "contains": "[concat('resourceGroups/',parameters('resourceGroupName'))]"
                      }
                    ]
                  },
                  "then": {
                    "effect": "deny"
                  }
                }
              }
            },
            {
              "Name": "Enforce-No-PublicIP",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Enforce-No-PublicIP",
              "ResourceName": "Enforce-No-PublicIP",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Enforce-No-PublicIP",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "resourceGroupName": {
                    "type": "String",
                    "metadata": {
                      "description": "Name of the resource group with ER Network",
                      "displayName": "ER Network Resource Group Name",
                      "strongType": "ExistingResourceGroups"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "allOf": [
                      {
                        "field": "type",
                        "equals": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings"
                      },
                      {
                        "field": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id",
                        "contains": "[concat('resourceGroups/',parameters('resourceGroupName'))]"
                      }
                    ]
                  },
                  "then": {
                    "effect": "deny"
                  }
                }
              }
            },
            {
              "Name": "Enforce-UDR",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Enforce-UDR",
              "ResourceName": "Enforce-UDR",
              "ResourceType": "Microsoft.Authorization/policyDefinitions",
              "SubscriptionId": null,
              "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Enforce-UDR",
              "Properties": {
                "Description": null,
                "DisplayName": null,
                "Mode": "All",
                "Parameters": {
                  "routeTableId": {
                    "type": "String",
                    "metadata": {
                      "displayName": "routeTable Id",
                      "description": "Resource Id of the routeTable",
                      "strongType": "routeTables"
                    }
                  }
                },
                "PolicyRule": {
                  "if": {
                    "anyOf": [
                      {
                        "allOf": [
                          {
                            "field": "type",
                            "equals": "Microsoft.Network/virtualNetworks"
                          },
                          {
                            "not": {
                              "field": "Microsoft.Network/virtualNetworks/subnets[*].routeTable.id",
                              "equals": "[parameters('routeTableId')]"
                            }
                          }
                        ]
                      },
                      {
                        "allOf": [
                          {
                            "field": "type",
                            "equals": "Microsoft.Network/virtualNetworks/subnets"
                          },
                          {
                            "not": {
                              "field": "Microsoft.Network/virtualNetworks/subnets/routeTable.id",
                              "equals": "[parameters('routeTableId')]"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "then": {
                    "effect": "deny"
                  }
                }
              }
            }
          ],
          "policySetDefinitions": [
            {
              "Name": "DINE-AzMon",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policySetDefinitions/DINE-AzMon",
              "ResourceName": "DINE-AzMon",
              "ResourceType": "Microsoft.Authorization/policySetDefinitions",
              "SubscriptionId": null,
              "PolicySetDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policySetDefinitions/DINE-AzMon",
              "Properties": {
                "Description": "Connects various Azure resource types to Azure Monitor Log Analytics for the gathering of metric and logs",
                "DisplayName": "DINE-AzMon",
                "Parameters": {
                  "logAnalytics": {
                    "type": "String",
                    "metadata": {
                      "displayName": "Log Analyitcs workspace",
                      "strongType": "omsWorkspace"
                    },
                    "allowedValues": [
                      "/subscriptions/832d2ee6-742b-4789-a57e-00bf5013fdc0/resourceGroups/operations-eu/providers/Microsoft.OperationalInsights/workspaces/c-loganalytics-eu"
                    ]
                  }
                },
                "PolicyDefinitionGroups": null,
                "PolicyDefinitions": [
                  {
                    "policyDefinitionReferenceId": "12195887802126275302",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonACI",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "17147010626115937533",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonACR",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "283537686566764211",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonADF",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "16828006335345171287",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonADLA",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "7893574873135673102",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonADLS",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "10661251344129828706",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAKS",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "5914961181371996838",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAppGW",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "15080340507942221385",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAS",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "43429383283530091",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonASA",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "977633626982153181",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonAutomation",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "3547636131147011646",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonBackup",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "16345989394785911108",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonBatch",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "17431594559340550789",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonCognitive",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "11863871030266273320",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonCosmos",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "3266202644060853395",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonDNS",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "10563779976487194909",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEGExtensionTopics",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "1000045887719058368",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEGSubscription",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "7803837509105100707",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEGTopics",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "3976126972698112550",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEHClusters",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "5301302378462754497",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonEHNamespace",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "10686964338986632067",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonER",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "15953091126167715358",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonHDInisght",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "15059845657882016508",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonIoT",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "73682663350954626",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonIoTPoS",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "8433251275609938800",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonKV",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "17645734162360874366",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonLB",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "13857188207191626843",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonLogicApp",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "10485166868050191980",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonLogicIA",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "6747579723556607049",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonMySQL",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "597835371151638258",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonNIC",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "15659810608548784901",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonNsg",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "11204095955448207195",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonPiP",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "14117548002203230528",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonPostGresSQL",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "4956323719118307428",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonRedis",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "17118316270630693366",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonRelay",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "18136374154749261118",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSB",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "4566789573909569605",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSearch",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "5729125055007030888",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSignalR",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "8590593814947641779",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSql",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "8964094718540607182",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSqlAS",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "10033847692436679486",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonTM",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "2028526387243318029",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonVNet",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "14259600765173874301",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonVNetGW",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  },
                  {
                    "policyDefinitionReferenceId": "10694113363391058258",
                    "policyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonWebSites",
                    "parameters": {
                      "logAnalytics": {
                        "value": "[parameters('logAnalytics')]"
                      }
                    }
                  }
                ]
              }
            }
          ],
          "policyAssignments": [
            {
              "Identity": {
                "type": "SystemAssigned",
                "principalId": "6f4afbba-0465-4503-91b3-7a6d04a3bf9c",
                "tenantId": "d6ad82f3-42af-4a15-ac1e-49e6c08f624e"
              },
              "Location": "eastus",
              "Name": "2d5cc716d8b747a2912937ea",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyAssignments/2d5cc716d8b747a2912937ea",
              "ResourceName": "2d5cc716d8b747a2912937ea",
              "ResourceGroupName": null,
              "ResourceType": "Microsoft.Authorization/policyAssignments",
              "SubscriptionId": null,
              "Sku": {
                "name": "A0",
                "tier": "Free"
              },
              "PolicyAssignmentId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyAssignments/2d5cc716d8b747a2912937ea",
              "Properties": {
                "Scope": "/providers/Microsoft.Management/managementgroups/cyrus",
                "NotScopes": [],
                "DisplayName": "DINE-AzMonER2",
                "Description": null,
                "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonER",
                "Parameters": {
                  "logAnalytics": {
                    "value": "/subscriptions/aeb777b3-3a06-4c47-ae0a-7095ce43cfe7/resourcegroups/1738284504/providers/microsoft.operationalinsights/workspaces/893401651"
                  }
                }
              }
            },
            {
              "Identity": null,
              "Location": "eastus",
              "Name": "40157fe6cf184d79be086315",
              "ResourceId": "/providers/Microsoft.Management/managementGroups/cyrus/providers/Microsoft.Authorization/policyAssignments/40157fe6cf184d79be086315",
              "ResourceName": "40157fe6cf184d79be086315",
              "ResourceGroupName": null,
              "ResourceType": "Microsoft.Authorization/policyAssignments",
              "SubscriptionId": null,
              "Sku": {
                "name": "A0",
                "tier": "Free"
              },
              "PolicyAssignmentId": "/providers/Microsoft.Management/managementGroups/cyrus/providers/Microsoft.Authorization/policyAssignments/40157fe6cf184d79be086315",
              "Properties": {
                "Scope": "/providers/Microsoft.Management/managementGroups/cyrus",
                "NotScopes": [
                  "/providers/Microsoft.Management/managementGroups/ib-dev"
                ],
                "DisplayName": "Not allowed resource types",
                "Description": null,
                "PolicyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
                "Parameters": {
                  "listOfResourceTypesNotAllowed": {
                    "value": [
                      "Microsoft.Network/publicIPAddresses"
                    ]
                  }
                }
              }
            },
            {
              "Identity": {
                "type": "SystemAssigned",
                "principalId": "e8024937-d227-459f-ac66-d47f994a4956",
                "tenantId": "d6ad82f3-42af-4a15-ac1e-49e6c08f624e"
              },
              "Location": "westeurope",
              "Name": "5d51f797a2784f63aef66dc9",
              "ResourceId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyAssignments/5d51f797a2784f63aef66dc9",
              "ResourceName": "5d51f797a2784f63aef66dc9",
              "ResourceGroupName": null,
              "ResourceType": "Microsoft.Authorization/policyAssignments",
              "SubscriptionId": null,
              "Sku": {
                "name": "A0",
                "tier": "Free"
              },
              "PolicyAssignmentId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyAssignments/5d51f797a2784f63aef66dc9",
              "Properties": {
                "Scope": "/providers/Microsoft.Management/managementgroups/cyrus",
                "NotScopes": [],
                "DisplayName": "DINE-AzMonSql",
                "Description": null,
                "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-AzMonSql",
                "Parameters": {
                  "logAnalytics": {
                    "value": "/subscriptions/aeb777b3-3a06-4c47-ae0a-7095ce43cfe7/resourcegroups/1738284504/providers/microsoft.operationalinsights/workspaces/893401651"
                  }
                }
              }
            },
            {
              "Identity": null,
              "Location": "eastus",
              "Name": "Deny-PublicIP",
              "ResourceId": "/providers/Microsoft.Management/managementGroups/cyrus/providers/Microsoft.Authorization/policyAssignments/Deny-PublicIP",
              "ResourceName": "Deny-PublicIP",
              "ResourceGroupName": null,
              "ResourceType": "Microsoft.Authorization/policyAssignments",
              "SubscriptionId": null,
              "Sku": {
                "name": "A0",
                "tier": "Free"
              },
              "PolicyAssignmentId": "/providers/Microsoft.Management/managementGroups/cyrus/providers/Microsoft.Authorization/policyAssignments/Deny-PublicIP",
              "Properties": {
                "Scope": "/providers/Microsoft.Management/managementGroups/cyrus",
                "NotScopes": [
                  "/providers/Microsoft.Management/managementGroups/ib-dev"
                ],
                "DisplayName": "Deny-PublicIP",
                "Description": "Denies the creation of public ip resources under root apart from a prescribed set of subnets",
                "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
                "Parameters": {
                  "subnets": {
                    "value": [
                      "/subscriptions/92b1b98d-6d0f-4252-91cf-e7dfdaf43a38/resourceGroups/m2-ne-prod-hub1-network-rg/providers/Microsoft.Network/virtualNetworks/m2-ne-prod-hub1/AzureFirewallSubnet"
                    ]
                  }
                }
              }
            },
            {
              "Identity": {
                "type": "SystemAssigned",
                "principalId": "fc24e1a9-7fd1-44e8-ba0f-3579dd8f1a57",
                "tenantId": "d6ad82f3-42af-4a15-ac1e-49e6c08f624e"
              },
              "Location": "northeurope",
              "Name": "DINE-Windows-Oms",
              "ResourceId": "/providers/Microsoft.Management/managementGroups/cyrus/providers/Microsoft.Authorization/policyAssignments/DINE-Windows-Oms",
              "ResourceName": "DINE-Windows-Oms",
              "ResourceGroupName": null,
              "ResourceType": "Microsoft.Authorization/policyAssignments",
              "SubscriptionId": null,
              "Sku": {
                "name": "A0",
                "tier": "Free"
              },
              "PolicyAssignmentId": "/providers/Microsoft.Management/managementGroups/cyrus/providers/Microsoft.Authorization/policyAssignments/DINE-Windows-Oms",
              "Properties": {
                "Scope": "/providers/Microsoft.Management/managementGroups/cyrus",
                "NotScopes": null,
                "DisplayName": "DINE-Windows-Oms",
                "Description": "Deploys the Log Analytics extension to Windows VMs",
                "PolicyDefinitionId": "/providers/Microsoft.Management/managementgroups/cyrus/providers/Microsoft.Authorization/policyDefinitions/DINE-Windows-Oms",
                "Parameters": {
                  "logAnalyticsEurope": {
                    "value": "/subscriptions/aeb777b3-3a06-4c47-ae0a-7095ce43cfe7/resourcegroups/la-test/providers/microsoft.operationalinsights/workspaces/test-la-dine"
                  },
                  "logAnalyticsNorthAmerica": {
                    "value": "/subscriptions/aeb777b3-3a06-4c47-ae0a-7095ce43cfe7/resourcegroups/la-test/providers/microsoft.operationalinsights/workspaces/test-la-dine"
                  },
                  "serviceMap": {
                    "value": "Yes"
                  }
                }
              }
            }
          ],
          "roleDefinitions": null,
          "roleAssignments": null
        }
      }
    }
  }
}
